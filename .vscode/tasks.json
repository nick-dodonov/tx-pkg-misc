{
    // See https://go.microsoft.com/fwlink/?LinkId=733558
    // for the documentation about the tasks.json format
    "version": "2.0.0",
    "tasks": [
        // ================ dev environment tasks
        {
            "type": "shell",
            "label": "compile_commands :refresh_all (OS)",
            "command": "bazel run @hedron_compile_commands//:refresh_all",
            "group": {
                "kind": "build",
            },
        },
        {
            "type": "shell",
            "label": "compile_commands :refresh_all (WASM)",
            "command": "bazel run @hedron_compile_commands//:refresh_all -- --config=wasm",
            "group": {
                "kind": "build",
            },
        },
        {
            "type": "shell",
            "label": "dev:init (force links)",
            "command": "bazel run @tx-kit-ext//tools/dev:init --override_module=tx-kit-ext=../tx-kit-ext -- -s",
            "group": {
                "kind": "build",
            },
            // https://code.visualstudio.com/docs/debugtest/tasks#_run-behavior
            "runOptions": {
                //ALWAYS runs "runOn": "folderOpen"
            }
        },
        // ================ build demo tasks
        // https://web.archive.org/web/20220716134022/https://shanee.io/blog/2019/05/28/bazel-with-visual-studio-code/
        {
            "type": "shell",
            "label": "build demo <user>",
            // --platform_suffix to differ CLI and VSCode debug builds (minimize incremental build issue)
            "command": "bazel build ${config:tx.debugTaskName} --platform_suffix=vs",
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "presentation": {
                "focus": true,
            },
            // https://code.visualstudio.com/docs/debugtest/tasks#_processing-task-output-with-problem-matchers
            "problemMatcher": "$gcc",
            // https://code.visualstudio.com/docs/debugtest/tasks#_defining-a-problem-matcher
            // "problemMatcher": {
            //     "owner": "cpp",
            //     "fileLocation": ["autoDetect", "${workspaceFolder}"],
            //     "source": "bazel-build",
            //     "pattern": {
            //         "regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
            //         "file": 1,
            //         "line": 2,
            //         "column": 3,
            //         "severity": 4,
            //         "message": 5
            //     }
            // }
        },
        // ================ build test tasks
        {
            "type": "shell",
            "label": "test:misc",
            "command": "bazel build test:misc",
            "group": {
                "kind": "build",
                "isDefault": true
            }
        },
        // ================ try w/ input variable
        {
            "label": "TRY TASK w/ Input Variable",
            "type": "shell",
            "command": "echo ${input:buildTarget}", // ${relativeFileDirname}
            "problemMatcher": []
        }
    ],
    // https://code.visualstudio.com/docs/reference/variables-reference#_input-variables
    // TODO: try Command Variable extension:
    // - https://stackoverflow.com/questions/71764897/vscode-how-to-generate-custom-task-input-options-from-a-command
    // - https://marketplace.visualstudio.com/items?itemName=rioj7.command-variable#pickstringremember
    "inputs": [
        {
            "id": "buildTarget",
            "type": "pickString",
            "options": [
                "demo:hello-pkg",
                "demo:hello-coro",
                "demo:try-asio",
                "demo:try-sdl3-1st",
                "demo:try-sdl3pp-1st",
                "test:misc"
            ],
            "description": "Select target to build",
        },
        {
            "id": "buildTarget(auto)",
            // "type": "promptString",
            // "type": "pickString",
            // https://github.com/bazel-contrib/vscode-bazel#bazel-tasks
            "type": "command",
            "command": "bazel.pickTarget",
            "args": {
                //"query": "kind(//test/...)",
                "placeHolder": "Select target to build",
            },
        }
    ]
}